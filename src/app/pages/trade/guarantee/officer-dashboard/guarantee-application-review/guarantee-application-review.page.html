<app-trade-layout organisationName="Trade Finance" solutionName="Guarantee Officer" breadcrumb="Guarantee Application Review" basePath="/trade">
  <div class="space-y-6">
    <section class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
      <div class="space-y-1">
        <h1 class="text-lg font-semibold text-slate-900">
          Guarantee Application Review &amp; SWIFT Preparation
        </h1>
        <p class="text-xs text-slate-500">
          Application ID:
          <span class="font-semibold text-slate-900">GTR-2024-001234</span>
        </p>
      </div>
      <div class="flex flex-wrap items-center gap-2">
        <button
          type="button"
          class="inline-flex items-center gap-2 rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm hover:bg-slate-50"
          (click)="goBackToDashboard()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-3.5 w-3.5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7 7-7"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 12h18"
            />
          </svg>
          <span>Back</span>
        </button>
      </div>
    </section>

    <section class="rounded-2xl border border-slate-200 bg-white px-6 py-4 shadow-sm">
      <div class="grid gap-4 md:grid-cols-6 items-start text-xs">
        <div class="space-y-1">
          <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
            Submitted
          </div>
          <div class="text-sm font-semibold text-slate-900">
            Jan 11, 2024
          </div>
          <div class="text-[11px] text-slate-500">
            09:15
          </div>
        </div>
        <div class="space-y-1">
          <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
            Type
          </div>
          <div class="text-sm font-semibold text-slate-900">
            Performance Guarantee
          </div>
        </div>
        <div class="space-y-1">
          <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
            Amount
          </div>
          <div class="text-sm font-semibold text-slate-900">
            USD 500,000.00
          </div>
        </div>
        <div class="space-y-1">
          <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
            Expiry
          </div>
          <div class="text-sm font-semibold text-slate-900">
            Dec 31, 2024
          </div>
        </div>
        <div class="space-y-1">
          <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
            Status
          </div>
          <div class="mt-1">
            <span
              class="inline-flex items-center rounded-full bg-emerald-50 px-3 py-1 text-[11px] font-semibold text-emerald-700"
            >
              Submitted
            </span>
          </div>
        </div>
        <div class="space-y-1">
          <div class="mt-5">
            <div
              class="inline-flex items-center rounded-md border border-slate-200 bg-slate-50 px-3 py-1 text-[11px] font-medium text-slate-700"
            >
              Customer Submitted
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="grid gap-6 lg:grid-cols-[2.1fr,1fr]">
      <div class="space-y-4">
        <section class="rounded-2xl bg-white p-5 text-xs shadow-sm">
          <div class="flex items-center justify-between">
            <h2 class="text-sm font-semibold text-slate-900">
              Customer &amp; Exposure Overview
            </h2>
          </div>
          <div class="mt-4 grid gap-4 md:grid-cols-4">
            <div class="space-y-2 rounded-xl border border-slate-200 bg-slate-50 p-4">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Customer
              </div>
              <div class="text-sm font-semibold text-slate-900">
                John Mitchell Trading LLC
              </div>
              <div class="text-[11px] text-slate-500">
                CIF: 1234567890
              </div>
              <div
                class="inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-semibold text-emerald-700"
              >
                Low Risk
              </div>
            </div>
            <div class="space-y-2 rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Funded Exposure
              </div>
              <div class="text-sm font-semibold text-slate-900">
                USD 2,500,000
              </div>
              <div class="text-[11px] text-slate-500">
                Current utilization
              </div>
            </div>
            <div class="space-y-2 rounded-xl border border-slate-200 bg-white p-4">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Non-Funded Exposure
              </div>
              <div class="text-sm font-semibold text-slate-900">
                USD 1,200,000
              </div>
              <div class="text-[11px] text-slate-500">
                Including this request
              </div>
            </div>
            <div class="space-y-2 rounded-xl border border-emerald-200 bg-emerald-50 p-4">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-emerald-700">
                Available Limit
              </div>
              <div class="text-sm font-semibold text-emerald-900">
                USD 3,800,000
              </div>
              <div class="text-[11px] text-emerald-700">
                Expires: Dec 2024
              </div>
              <div class="text-[11px] font-semibold text-emerald-700">
                Within Limit
              </div>
            </div>
          </div>
        </section>

        <section class="rounded-2xl bg-white p-5 text-xs shadow-sm">
          <h2 class="text-sm font-semibold text-slate-900">
            Application Core Data
          </h2>
          <div class="mt-4 grid gap-4 md:grid-cols-2">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Guarantee Category
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Bank Guarantee
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Expiry Date
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Dec 31, 2024
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Guarantee Type
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Performance Guarantee
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Claim Period
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                30 Days
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Governing Rules
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                URDG 758
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Proposed Issue Date
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Jan 11, 2024
              </div>
            </div>
            <div class="md:col-span-2 space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Guarantee Purpose
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Performance guarantee for construction project XYZ with ABC Construction Company as per contract
                dated Jan 5, 2024.
              </div>
            </div>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-5 text-xs shadow-sm">
          <div class="flex items-center justify-between">
            <h2 class="text-sm font-semibold text-slate-900">
              Existing Guarantees Overview
            </h2>
          </div>
          <div class="mt-3 overflow-x-auto">
            <app-ui-table>
              <thead class="bg-slate-50">
                <tr class="text-left text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                  <th class="px-4 py-2">Reference</th>
                  <th class="px-4 py-2">Type</th>
                  <th class="px-4 py-2">Amount</th>
                  <th class="px-4 py-2">Expiry</th>
                  <th class="px-4 py-2">Status</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-100 bg-white">
                <tr *ngFor="let row of existingGuarantees" class="text-xs hover:bg-slate-50">
                  <td class="px-4 py-2 text-blue-700">
                    {{ row.reference }}
                  </td>
                  <td class="px-4 py-2 text-slate-700">
                    {{ row.type }}
                  </td>
                  <td class="px-4 py-2 text-slate-900">
                    {{ row.amount }}
                  </td>
                  <td class="px-4 py-2 text-slate-600">
                    {{ row.expiry }}
                  </td>
                  <td class="px-4 py-2">
                    <span
                      class="inline-flex items-center rounded-full bg-emerald-50 px-3 py-1 text-[11px] font-semibold text-emerald-700"
                    >
                      {{ row.status }}
                    </span>
                  </td>
                </tr>
              </tbody>
            </app-ui-table>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-5 text-xs shadow-sm">
          <h2 class="text-sm font-semibold text-slate-900">
            Financial Parameters
          </h2>
          <div class="mt-4 grid gap-4 md:grid-cols-3">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Proposed Margin %
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                15%
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Margin Amount
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                USD 75,000.00
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Commission Rate
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                0.75% per quarter
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Charges Bearing
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                Applicant
              </div>
            </div>
            <div class="space-y-1">
              <div class="text-[11px] font-semibold uppercase tracking-wide text-slate-500">
                Debit Account
              </div>
              <div class="rounded-md border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-900">
                •••• •••• •••• 4521
              </div>
            </div>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-5 text-xs shadow-sm">
          <h2 class="text-sm font-semibold text-slate-900">
            Uploaded Documents
          </h2>
          <div class="mt-3 space-y-2">
            <div
              *ngFor="let doc of uploadedDocuments"
              class="flex items-center justify-between rounded-lg border border-slate-200 bg-slate-50 px-4 py-3"
            >
              <div class="space-y-1">
                <div class="flex items-center gap-2">
                  <span class="text-[11px] font-semibold text-slate-900">
                    {{ doc.name }}
                  </span>
                  <span
                    class="inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-semibold text-emerald-700"
                  >
                    {{ doc.status }}
                  </span>
                </div>
                <div class="text-[11px] text-slate-500">
                  {{ doc.fileName }} • {{ doc.size }} • Uploaded: {{ doc.uploadedAt }}
                </div>
              </div>
              <button
                type="button"
                class="text-[11px] font-semibold text-blue-600 hover:text-blue-700"
              >
                Preview
              </button>
            </div>
          </div>
        </section>
      </div>

      <div class="space-y-4 text-xs">
        <section class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm">
          <h2 class="text-sm font-semibold text-slate-900">
            Review Checklist
          </h2>
          <div class="mt-3 space-y-2">
            <label
              *ngFor="let item of checklist"
              class="flex items-center gap-2"
            >
              <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300 text-blue-600" checked />
              <span class="text-[11px] text-slate-700">
                {{ item }}
              </span>
            </label>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm">
          <h2 class="text-sm font-semibold text-slate-900">
            Review Notes
          </h2>
          <div class="mt-3 space-y-3">
            <div class="space-y-1">
              <div class="text-[11px] font-semibold text-slate-600">
                Deficiency Reasons (if any)
              </div>
              <div class="space-y-1">
                <label
                  *ngFor="let reason of deficiencyReasons"
                  class="flex items-center gap-2"
                >
                  <input type="checkbox" class="h-3.5 w-3.5 rounded border-slate-300" />
                  <span class="text-[11px] text-slate-700">
                    {{ reason }}
                  </span>
                </label>
              </div>
            </div>
            <div class="space-y-1">
              <app-ui-input
                label="Optional internal remarks"
                type="textarea"
                placeholder="Enter internal processing notes..."
              ></app-ui-input>
            </div>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm">
          <div class="flex items-center gap-2">
            <div class="flex h-7 w-7 items-center justify-center rounded-full bg-blue-50 text-blue-600">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M2 12h20"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 2v20"
                />
              </svg>
            </div>
            <h2 class="text-sm font-semibold text-slate-900">
              SWIFT Requirement
            </h2>
          </div>
          <div class="mt-3 space-y-2">
            <label
              class="flex items-center gap-3 rounded-md px-3 py-2 cursor-pointer"
              [ngClass]="
                swiftRequirement === 'not-required'
                  ? 'border-blue-600 bg-blue-50'
                  : 'border-slate-300 bg-white'
              "
            >
              <input
                type="radio"
                name="swift"
                class="h-3.5 w-3.5 rounded-full border-slate-300 text-blue-600"
                [checked]="swiftRequirement === 'not-required'"
                (change)="swiftRequirement = 'not-required'"
              />
              <span class="text-[11px] font-medium text-slate-800">
                SWIFT Not Required
              </span>
            </label>
            <label
              class="flex items-center gap-3 rounded-md px-3 py-2 cursor-pointer"
              [ngClass]="
                swiftRequirement === 'required'
                  ? 'border-blue-600 bg-blue-50'
                  : 'border-slate-300 bg-white'
              "
            >
              <input
                type="radio"
                name="swift"
                class="h-3.5 w-3.5 rounded-full border-blue-600 text-blue-600"
                [checked]="swiftRequirement === 'required'"
                (change)="swiftRequirement = 'required'"
              />
              <span class="text-[11px] font-medium text-blue-800">
                SWIFT Required
              </span>
            </label>
            <p class="mt-2 rounded-md border border-blue-100 bg-blue-50 px-3 py-2 text-[11px] text-blue-900">
              SWIFT message must be prepared before escalation to checker.
            </p>
            <button
              type="button"
              class="mt-2 inline-flex w-full items-center justify-center gap-2 rounded-md bg-blue-600 px-3 py-2 text-[11px] font-semibold text-white hover:bg-blue-700"
              (click)="createSwiftMessage()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 5v14"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 12h14"
                />
              </svg>
              <span>Create SWIFT Message</span>
            </button>
          </div>
        </section>

        <section class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm">
          <div class="flex items-center gap-2">
            <div class="flex h-7 w-7 items-center justify-center rounded-full bg-blue-50 text-blue-600">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4"
                />
              </svg>
            </div>
            <h2 class="text-sm font-semibold text-slate-900">
              Final Decision
            </h2>
          </div>
          <div class="mt-3 space-y-2">
            <label
              class="flex items-start gap-3 rounded-md px-3 py-2 cursor-pointer"
              [ngClass]="
                finalDecision === 'send-back'
                  ? 'border-blue-600 bg-blue-50'
                  : 'border-slate-300 bg-white'
              "
            >
              <input
                type="radio"
                name="decision"
                class="mt-0.5 h-3.5 w-3.5 rounded-full border-slate-300 text-blue-600"
                [checked]="finalDecision === 'send-back'"
                (change)="finalDecision = 'send-back'"
              />
              <span>
                <span class="block text-[11px] font-semibold text-slate-800">
                  Send Back for Correction
                </span>
                <span class="block text-[11px] text-slate-500">
                  Return to customer with notes
                </span>
              </span>
            </label>
            <label
              class="flex items-start gap-3 rounded-md px-3 py-2 cursor-pointer"
              [ngClass]="
                finalDecision === 'escalate'
                  ? 'border-blue-600 bg-blue-50'
                  : 'border-slate-300 bg-white'
              "
            >
              <input
                type="radio"
                name="decision"
                class="mt-0.5 h-3.5 w-3.5 rounded-full border-blue-600 text-blue-600"
                [checked]="finalDecision === 'escalate'"
                (change)="finalDecision = 'escalate'"
              />
              <span>
                <span class="block text-[11px] font-semibold text-slate-800">
                  Escalate to Guarantee Checker
                </span>
                <span class="block text-[11px] text-slate-500">
                  Proceed with SWIFT for approval
                </span>
              </span>
            </label>
          </div>
          <div class="mt-4 flex flex-col gap-2">
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-md bg-slate-100 px-3 py-2 text-[11px] font-semibold text-slate-700 hover:bg-slate-200"
              (click)="goBackToDashboard()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 19l-7-7 7-7"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12h18"
                />
              </svg>
              <span>Cancel / Back</span>
            </button>
            <button
              type="button"
              class="inline-flex w-full items-center justify-center gap-2 rounded-md bg-emerald-600 px-3 py-2 text-[11px] font-semibold text-white hover:bg-emerald-700"
              (click)="submitAndEscalate()"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-3.5 w-3.5"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 17l8-8"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 7h8v8"
                />
              </svg>
              <span>Submit &amp; Escalate</span>
            </button>
          </div>
        </section>
      </div>
    </section>
  </div>
</app-trade-layout>
